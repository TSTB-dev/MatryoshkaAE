export CUDA_VISIBLE_DEVICES=0 &&
python src/train.py \
    --data_root data/mvtec_ad \
    --class_name screw \
    --num_normal_samples -1 \
    --ae_model conv_ae_sp2 \
    --ae_hidden_dim 384 \
    --bottleneck_dim 64 \
    --backbone_model pdn_small \
    --backbone_resume_path ./weights/teacher_small.pth \
    --feature_dim 384 \
    --feature_res 2 \
    --img_size 256 \
    --split train \
    --batch_size 8 \
    --num_epochs 100 \
    --lr 0.0001 \
    --momentum 0.9 \
    --weight_decay 0.05 \
    --optimizer adamw \
    --scheduler cosine \
    --grad_clip 1.0 \
    --seed 42 \
    --num_workers 1 \
    --device cuda \
    --log_interval 10 \
    --save_dir results &

export CUDA_VISIBLE_DEVICES=1 &&
python src/train.py \
    --data_root data/mvtec_ad \
    --class_name screw \
    --num_normal_samples -1 \
    --ae_model conv_ae_sp4 \
    --ae_hidden_dim 384 \
    --bottleneck_dim 64 \
    --backbone_model pdn_small \
    --backbone_resume_path ./weights/teacher_small.pth \
    --feature_dim 384 \
    --feature_res 4 \
    --img_size 256 \
    --split train \
    --batch_size 8 \
    --num_epochs 100 \
    --lr 0.0001 \
    --momentum 0.9 \
    --weight_decay 0.05 \
    --optimizer adamw \
    --scheduler cosine \
    --grad_clip 1.0 \
    --seed 42 \
    --num_workers 1 \
    --device cuda \
    --log_interval 10 \
    --save_dir results &

export CUDA_VISIBLE_DEVICES=2 &&
python src/train.py \
    --data_root data/mvtec_ad \
    --class_name screw \
    --num_normal_samples -1 \
    --ae_model conv_ae_sp8 \
    --ae_hidden_dim 384 \
    --bottleneck_dim 64 \
    --backbone_model pdn_small \
    --backbone_resume_path ./weights/teacher_small.pth \
    --feature_dim 384 \
    --feature_res 8 \
    --img_size 256 \
    --split train \
    --batch_size 8 \
    --num_epochs 100 \
    --lr 0.0001 \
    --momentum 0.9 \
    --weight_decay 0.05 \
    --optimizer adamw \
    --scheduler cosine \
    --grad_clip 1.0 \
    --seed 42 \
    --num_workers 1 \
    --device cuda \
    --log_interval 10 \
    --save_dir results &

export CUDA_VISIBLE_DEVICES=3 &&
python src/train.py \
    --data_root data/mvtec_ad \
    --class_name screw \
    --num_normal_samples -1 \
    --ae_model conv_ae_sp16 \
    --ae_hidden_dim 384 \
    --bottleneck_dim 64 \
    --backbone_model pdn_small \
    --backbone_resume_path ./weights/teacher_small.pth \
    --feature_dim 384 \
    --feature_res 16 \
    --img_size 256 \
    --split train \
    --batch_size 8 \
    --num_epochs 100 \
    --lr 0.0001 \
    --momentum 0.9 \
    --weight_decay 0.05 \
    --optimizer adamw \
    --scheduler cosine \
    --grad_clip 1.0 \
    --seed 42 \
    --num_workers 1 \
    --device cuda \
    --log_interval 10 \
    --save_dir results & 
